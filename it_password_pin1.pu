@startuml
title Windows 11 MSA PIN vs ローカルアカウントパスワード

actor User as U
participant "① Windows 端末" as PC
participant "② TPM / Security Module" as TPM
participant "③ Microsoft Auth Server" as MSA
participant "④ Local SAM Database" as LocalDB

== Microsoft アカウント PIN (Windows Hello) ==
U -> PC : ① PIN入力（例: 1234）
PC -> TPM : ② 秘密鍵使用許可要求
TPM -> PC : ② 承認
PC -> MSA : ③ アカウント情報送信（**PIN自体は送らない**）
MSA -> PC : ③ 認証結果返却
PC --> U : ログイン成功/失敗

note right

* PINは端末固有
* TPMに保存された秘密鍵を使用
* PIN自体はネットワークに送られない
* フィッシング耐性あり
  end note

== ローカルアカウントパスワード ==
U -> PC : ① パスワード入力（例: 1234）
PC -> LocalDB : ④ ハッシュ照合
LocalDB -> PC : ④ 認証結果返却
PC --> U : ログイン成功/失敗

note right

* パスワードはPC内のハッシュと照合
* 他端末にコピーしても同じパスワードが使える
* ネットワークには送信されない（ローカル認証）
  end note

@enduml
