<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="746px" preserveAspectRatio="none" style="width:835px;height:746px;background:#FFFFFF;" version="1.1" viewBox="0 0 835 746" width="835px" zoomAndPan="magnify"><defs/><g><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="584.3906" width="8" x="19.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="665.6875"/></g><g><title>NixOS System</title><rect fill="#000000" fill-opacity="0.00000" height="584.3906" width="8" x="182.9561" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="186.3511" x2="186.3511" y1="81.2969" y2="665.6875"/></g><g><title>Home Manager</title><rect fill="#000000" fill-opacity="0.00000" height="584.3906" width="8" x="509.333" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="512.7529" x2="512.7529" y1="81.2969" y2="665.6875"/></g><g><title>Flake System</title><rect fill="#000000" fill-opacity="0.00000" height="584.3906" width="8" x="652.5356" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="655.5864" x2="655.5864" y1="81.2969" y2="665.6875"/></g><g><title>Overlays</title><rect fill="#000000" fill-opacity="0.00000" height="584.3906" width="8" x="781.5322" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="784.6714" x2="784.6714" y1="81.2969" y2="665.6875"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="77.9951">User</text><ellipse cx="23.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,21.5 L23.9551,48.5 M10.9551,29.5 L36.9551,29.5 M23.9551,48.5 L10.9551,63.5 M23.9551,48.5 L36.9551,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="677.6826">User</text><ellipse cx="23.9551" cy="689.4844" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,697.4844 L23.9551,724.4844 M10.9551,705.4844 L36.9551,705.4844 M23.9551,724.4844 L10.9551,739.4844 M23.9551,724.4844 L36.9551,739.4844" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="System"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.21" x="130.3511" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.21" x="137.3511" y="69.9951">NixOS System</text></g><g class="participant participant-tail" data-participant="System"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.21" x="130.3511" y="664.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.21" x="137.3511" y="684.6826">NixOS System</text></g><g class="participant participant-head" data-participant="HM"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.1602" x="452.7529" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.1602" x="459.7529" y="69.9951">Home Manager</text></g><g class="participant participant-tail" data-participant="HM"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.1602" x="452.7529" y="664.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.1602" x="459.7529" y="684.6826">Home Manager</text></g><g class="participant participant-head" data-participant="Flake"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.8984" x="602.5864" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.8984" x="609.5864" y="69.9951">Flake System</text></g><g class="participant participant-tail" data-participant="Flake"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.8984" x="602.5864" y="664.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.8984" x="609.5864" y="684.6826">Flake System</text></g><g class="participant participant-head" data-participant="Overlay"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7217" x="747.6714" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7217" x="754.6714" y="69.9951">Overlays</text></g><g class="participant participant-tail" data-participant="Overlay"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7217" x="747.6714" y="664.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7217" x="754.6714" y="684.6826">Overlays</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="828.3931" x="0" y="111.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="111.8633" y2="111.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="114.8633" y2="114.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="162.7637" x="332.8147" y="101.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.2378" x="338.8147" y="117.3638">Step 1: Basic NixOS</text><g class="message" data-participant-1="User" data-participant-2="System"><polygon fill="#181818" points="174.9561,151.5625,184.9561,155.5625,174.9561,159.5625,178.9561,155.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="180.9561" y1="155.5625" y2="155.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.001" x="30.9551" y="150.4966">edit configuration.nix</text></g><g class="message" data-participant-1="System" data-participant-2="System"><line style="stroke:#181818;stroke-width:1;" x1="186.9561" x2="228.9561" y1="184.6953" y2="184.6953"/><line style="stroke:#181818;stroke-width:1;" x1="228.9561" x2="228.9561" y1="184.6953" y2="197.6953"/><line style="stroke:#181818;stroke-width:1;" x1="187.9561" x2="228.9561" y1="197.6953" y2="197.6953"/><polygon fill="#181818" points="197.9561,193.6953,187.9561,197.6953,197.9561,201.6953,193.9561,197.6953" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.1782" x="193.9561" y="179.6294">define basic services, packages</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="828.3931" x="0" y="226.2617"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="226.2617" y2="226.2617"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="229.2617" y2="229.2617"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="272.083" x="278.155" y="215.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="253.5571" x="284.155" y="231.7622">Step 2: Home Manager (non-flake)</text><g class="message" data-participant-1="User" data-participant-2="HM"><polygon fill="#181818" points="501.333,265.9609,511.333,269.9609,501.333,273.9609,505.333,269.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="507.333" y1="269.9609" y2="269.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.1987" x="30.9551" y="264.895">enable home-manager in configuration.nix</text></g><g class="message" data-participant-1="System" data-participant-2="HM"><polygon fill="#181818" points="501.333,295.0938,511.333,299.0938,501.333,303.0938,505.333,299.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="186.9561" x2="507.333" y1="299.0938" y2="299.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.377" x="193.9561" y="294.0278">apply home-manager configs via nixos-rebuild</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="828.3931" x="0" y="327.6602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="327.6602" y2="327.6602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="330.6602" y2="330.6602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="190.3569" x="319.0181" y="317.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.8311" x="325.0181" y="333.1606">Step 3: Flake Migration</text><g class="message" data-participant-1="User" data-participant-2="Flake"><polygon fill="#181818" points="644.5356,382.4922,654.5356,386.4922,644.5356,390.4922,648.5356,386.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="650.5356" y1="386.4922" y2="386.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.1743" x="30.9551" y="366.2935">write flake.nix</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.272" x="30.9551" y="381.4263">(inputs, outputs)</text></g><g class="message" data-participant-1="Flake" data-participant-2="System"><polygon fill="#181818" points="197.9561,411.625,187.9561,415.625,197.9561,419.625,193.9561,415.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="191.9561" x2="655.5356" y1="415.625" y2="415.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.8257" x="203.9561" y="410.5591">load configuration.nix</text></g><g class="message" data-participant-1="Flake" data-participant-2="HM"><polygon fill="#181818" points="524.333,455.8906,514.333,459.8906,524.333,463.8906,520.333,459.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="518.333" x2="655.5356" y1="459.8906" y2="459.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.5864" x="530.333" y="439.6919">import home.nix</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2026" x="530.333" y="454.8247">from flake module</text></g><g class="message" data-participant-1="System" data-participant-2="System"><line style="stroke:#181818;stroke-width:1;" x1="186.9561" x2="228.9561" y1="504.1563" y2="504.1563"/><line style="stroke:#181818;stroke-width:1;" x1="228.9561" x2="228.9561" y1="504.1563" y2="517.1563"/><line style="stroke:#181818;stroke-width:1;" x1="187.9561" x2="228.9561" y1="517.1563" y2="517.1563"/><polygon fill="#181818" points="197.9561,513.1563,187.9561,517.1563,197.9561,521.1563,193.9561,517.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.3706" x="193.9561" y="483.9575">rebuild using flake</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.2939" x="193.9561" y="499.0903">(--flake .#hostname)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="828.3931" x="0" y="545.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="545.7227" y2="545.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="828.3931" y1="548.7227" y2="548.7227"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="227.2749" x="300.5591" y="535.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="208.749" x="306.5591" y="551.2231">Step 4: Overlay Introduction</text><g class="message" data-participant-1="User" data-participant-2="Overlay"><polygon fill="#181818" points="773.5322,585.4219,783.5322,589.4219,773.5322,593.4219,777.5322,589.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="779.5322" y1="589.4219" y2="589.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.3159" x="30.9551" y="584.356">define overlays in flake.nix</text></g><g class="message" data-participant-1="Overlay" data-participant-2="Flake"><polygon fill="#181818" points="667.5356,614.5547,657.5356,618.5547,667.5356,622.5547,663.5356,618.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="661.5356" x2="784.5322" y1="618.5547" y2="618.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9966" x="673.5356" y="613.4888">overlays = [ ... ]</text></g><g class="message" data-participant-1="Flake" data-participant-2="System"><polygon fill="#181818" points="197.9561,643.6875,187.9561,647.6875,197.9561,651.6875,193.9561,647.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="191.9561" x2="655.5356" y1="647.6875" y2="647.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.2212" x="203.9561" y="642.6216">apply overlay via nixpkgs.overlays</text></g><!--SRC=[VP8_RuCm4CLtFiMfNHAf8FNFX4I73bKwq0nHfxR31Gvo2jYMRTBasnTiGqWLTJFSx-xUUpOMLchuCAGZXTfomGg5XPjtFguti3aPI-qDe0d7IsWbMu8S1TQa7RJABu7N1lSqd-9-N3Bh0-a6JyRLmqSKPHbiB2cuJ-453HVW1MLPD6Y5-3bCXHIeP0k551NNdKRBKYI2Zr6epycIAXO4MpUm7tFWWimTA2pslGLptlgGmjmRB8GKSJLeNyubhF9XlS1jGx3h-RWDF8j_1Ra-LAevNRRv7WC7HkWxf8arRJjkohEonzHd23dNVlPSa2-byAFP4ZZ1m-eliM2XEjjxbPqT3il8e_Dq6edb5TaJw5HpgwIsJhQVN6dP-atGoh9hw5hmmGPqXaNjwLvJx2E5v7OdZHNOql9iz2aT7mEy2QlxqSLVjsDzkbWPdjAG_sG-6h5PFXEOmISaIGBVL_Bm5nJGyKxKlZR9sFuB]--></g></svg>