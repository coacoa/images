<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SSHè¶Šã—ã« clipboard (+y) ãŒçªç„¶ä½¿ãˆãªããªã£ãŸæ™‚ã®å³å¾©æ—§ãƒ¡ãƒ¢</title>
  <meta name="description" content="NixOS/SSH/Vim/Neovim ã§ X11 Forwarding ãŒåŸå› ã® clipboard æ–­çµ¶ã‚’5åˆ†ã§å¾©æ—§ã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ" />
  <style>
    :root {
      --bg: #0f1220;
      --fg: #e8eaf6;
      --muted: #b0b6d6;
      --accent: #8ab4ff;
      --ok: #7ee787;
      --warn: #f2cc60;
      --bad: #ff7b72;
      --card: #151935;
      --code: #0b0e1a;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 24px;
      background: var(--bg); color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans JP", sans-serif;
      line-height: 1.7;
    }
    main { max-width: 980px; margin: 0 auto; }
    h1, h2, h3 { line-height: 1.3; }
    h1 { font-size: 1.9rem; margin-bottom: .25rem; }
    .subtitle { color: var(--muted); margin-bottom: 1.5rem; }
    section { background: var(--card); border-radius: 12px; padding: 18px 20px; margin: 16px 0; box-shadow: 0 8px 24px rgba(0,0,0,.25); }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: .75rem; margin-right: 6px; }
    .ok { background: rgba(126,231,135,.15); color: var(--ok); }
    .warn { background: rgba(242,204,96,.15); color: var(--warn); }
    .bad { background: rgba(255,123,114,.15); color: var(--bad); }
    ul { padding-left: 1.2rem; }
    li { margin: .25rem 0; }
    pre, code { background: var(--code); color: #e6edf3; }
    pre { padding: 14px; border-radius: 10px; overflow-x: auto; }
    code { padding: 2px 6px; border-radius: 6px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 12px; }
    footer { color: var(--muted); margin-top: 24px; text-align: center; }
  </style>
</head>
<body>
  <main>
    <h1>SSHè¶Šã—ã« <code>+y</code>ï¼ˆclipboardï¼‰ãŒçªç„¶ä½¿ãˆãªããªã£ãŸæ™‚ã®å³å¾©æ—§ãƒ¡ãƒ¢</h1>
    <div class="subtitle">NixOS / OpenSSH / Vimãƒ»Neovim å‘ã‘ãƒ»å†ç™ºå‰æãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</div>

    <section>
      <h2>ç—‡çŠ¶</h2>
      <ul>
        <li>SSHå…ˆã® Vim / Neovim / Emacs ã§ <code>"+y</code> ã—ã¦ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã«è²¼ã‚Œãªã„</li>
        <li>æ˜¨æ—¥ã¾ã§å‡ºæ¥ã¦ã„ãŸã®ã« <strong>çªç„¶æ­»</strong></li>
      </ul>
    </section>

    <section>
      <h2>åŸå› ï¼ˆä»Šå›ã®çµè«–ï¼‰</h2>
      <p><span class="badge bad">åŸå› </span> æ¥ç¶šå…ˆ <strong>sshd ãŒ X11 Forwarding ã‚’ç¦æ­¢</strong>ã—ã¦ã„ãŸã€‚</p>
      <pre><code>X11 forwarding request failed on channel 0</code></pre>
      <pre><code>X11Forwarding no</code></pre>
      <p>ğŸ‘‰ å£Šã‚ŒãŸã®ã§ã¯ãªãã€<strong>è¨­å®šã©ãŠã‚Šæ‹’å¦</strong>ã•ã‚Œã¦ã„ãŸã€‚</p>
    </section>

    <section>
      <h2>å³ãƒã‚§ãƒƒã‚¯æ‰‹é †ï¼ˆå†ç™ºæ™‚ã¯ã“ã“ã‹ã‚‰ï¼‰</h2>
      <ol>
        <li>
          <strong>DISPLAY ã‚’ç¢ºèª</strong>
          <pre><code>echo $DISPLAY</code></pre>
          <ul>
            <li><span class="badge bad">NG</span> ç©º â†’ X11 æœªæ¥ç¶š</li>
            <li><span class="badge ok">OK</span> <code>localhost:10.0</code> â†’ X11 OK</li>
          </ul>
        </li>
        <li>
          <strong><code>ssh -X</code> ã§å…¥ã‚Šç›´ã™</strong>
          <pre><code>ssh -X user@host</code></pre>
          <p>ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªã‚‰ <strong>sshd å´</strong>ã€‚</p>
        </li>
      </ol>
    </section>

    <section>
      <h2>NixOSï¼ˆæ¥ç¶šå…ˆï¼‰ã§ã®æ­£è§£è¨­å®š</h2>
      <pre><code>services.openssh = {
  enable = true;
  settings = {
    X11Forwarding = true;
  };
};</code></pre>
      <pre><code>sudo nixos-rebuild switch</code></pre>
    </section>

    <section>
      <h2>xauth ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆï¼ˆåˆå›ã‚ã‚‹ã‚ã‚‹ï¼‰</h2>
      <pre><code>xauth: file ~/.Xauthority does not exist</code></pre>
      <pre><code>touch ~/.Xauthority
chmod 600 ~/.Xauthority</code></pre>
      <p>â†’ å†æ¥ç¶š</p>
    </section>

    <section>
      <h2>æœ€çµ‚ç¢ºèª</h2>
      <div class="grid">
        <pre><code>echo $DISPLAY</code></pre>
        <pre><code>"+yy</code></pre>
      </div>
      <p>ãƒ­ãƒ¼ã‚«ãƒ«ã«è²¼ã‚ŒãŸã‚‰ <span class="badge ok">å¾©æ—§å®Œäº†</span></p>
    </section>

    <section>
      <h2>ãªãœã€Œã„ã¤ã®é–“ã«ã‹ã€èµ·ãã‚‹ï¼Ÿ</h2>
      <ul>
        <li>NixOS / OpenSSH æ›´æ–°</li>
        <li>sshd hardening</li>
        <li>Wayland å‰æåŒ–</li>
        <li>è¸ã¿å°ãƒ»åˆ¥ãƒ›ã‚¹ãƒˆçµŒç”±</li>
      </ul>
      <p>ğŸ‘‰ <strong>X11 ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§åˆ‡ã‚‰ã‚Œã‚„ã™ã„</strong></p>
    </section>

    <section>
      <h2>é‡è¦ãƒ¡ãƒ¢ï¼ˆå°†æ¥ã¾ãŸæŠ˜ã‚Œã‚‹ï¼‰</h2>
      <ul>
        <li>ä¸å®‰å®š</li>
        <li>sshd è¨­å®šä¾å­˜</li>
        <li>tmux / Wayland ã¨ç›¸æ€§æ‚ªã„</li>
      </ul>
      <p><strong>å®‰å®šè§£ï¼š</strong> <span class="badge ok">OSC52 clipboard</span>ï¼ˆX11 ä¸è¦ãƒ»sshd ä¸è¦ï¼‰</p>
    </section>

    <section>
      <h2>åˆè¨€è‘‰</h2>
      <blockquote>
        ã€Œå£Šã‚ŒãŸã€ã˜ã‚ƒãªã„ã€<strong>ã€Œssh ã®æµå„€ãŒå¤‰ã‚ã£ãŸã€ã ã‘</strong>
      </blockquote>
      <p>ã“ã®ãƒ¡ãƒ¢é€šã‚Šã‚„ã‚Œã° <strong>5åˆ†ã§å¾©æ—§</strong>ã€‚</p>
    </section>

    <footer>
      <p>Â© Memo for future me. Keep calm and <code>echo $DISPLAY</code>.</p>
    </footer>
  </main>
</body>
</html>

